<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Churn Rate Prediction Using Neural Networks - Eric Chen's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="https://ericchen23.github.io/images/icon2.png" rel="icon">

<link rel="canonical" href="https://ericchen23.github.io/2018/08/Churn-rate-prediction.html">

        <meta name="author" content="Hao Chen" />
        <meta name="keywords" content="Data Science,Analytics" />
        <meta name="description" content="The basic aim of this post is to predict customer churn for a certain bank i.e. which customer is going to leave this bank service. Fully-connected neural networks with different architectures will be explored and compared. Since this is a binary prediction , logistic regression may also works pretty well. Feel free to give it a shot~" />

        <meta property="og:site_name" content="Eric Chen's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Churn Rate Prediction Using Neural Networks"/>
        <meta property="og:url" content="https://ericchen23.github.io/2018/08/Churn-rate-prediction.html"/>
        <meta property="og:description" content="The basic aim of this post is to predict customer churn for a certain bank i.e. which customer is going to leave this bank service. Fully-connected neural networks with different architectures will be explored and compared. Since this is a binary prediction , logistic regression may also works pretty well. Feel free to give it a shot~"/>
        <meta property="article:published_time" content="2018-08-20" />
            <meta property="article:section" content="Data Science" />
            <meta property="article:tag" content="Data Science" />
            <meta property="article:tag" content="Analytics" />
            <meta property="article:author" content="Hao Chen" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://ericchen23.github.io/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="https://ericchen23.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://ericchen23.github.io/theme/css/pygments/emacs.css" rel="stylesheet">
    <link href="https://ericchen23.github.io/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="https://ericchen23.github.io/theme/css/style.css" type="text/css"/>
        <link href="https://ericchen23.github.io/theme/css/custom.css" rel="stylesheet">

        <link href="https://ericchen23.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Eric Chen's Blog ATOM Feed"/>

        <link href="https://ericchen23.github.io/feeds/%s.atom.xml" type="application/atom+xml" rel="alternate"
              title="Eric Chen's Blog Data Science ATOM Feed"/>
</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://ericchen23.github.io/" class="navbar-brand">
<img class="img-responsive pull-left gap-right" src="https://ericchen23.github.io/images/icon.jpg" width="28"/> Eric Chen's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/category/data-science/index.html">Data Science</a></li>
                    <li><a href="/category/nlp/index.html">NLP</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="https://ericchen23.github.io/archives/"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="https://ericchen23.github.io" title="Eric Chen's Blog"><i class="fa fa-home fa-lg"></i></a></li>
                <li class="active">Churn Rate Prediction Using Neural Networks</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://ericchen23.github.io/2018/08/Churn-rate-prediction.html"
                       rel="bookmark"
                       title="Permalink to Churn Rate Prediction Using Neural Networks">
                        Churn Rate Prediction Using Neural Networks
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-08-20T12:25:00+12:00"> Mon 20 August 2018</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://ericchen23.github.io/author/hao-chen.html"><i class="fa fa-user"></i> Hao Chen</a>



<span class="label label-default">Tags</span>
	<a href="https://ericchen23.github.io/label/data-science/">Data Science</a>
        /
	<a href="https://ericchen23.github.io/label/analytics/">Analytics</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Churn-Rate-Prediction-for-a-bank">Churn Rate Prediction for a bank<a class="anchor-link" href="#Churn-Rate-Prediction-for-a-bank">&#182;</a></h1><p>The basic aim of this notebook is to predict customer churn for a certain bank i.e. which customer is going to leave this bank service.</p>
<p>Neural network will be used as the modelling method for this notebook. The dataset used in this notebook is introduced by Pushkar Mandot on his blog post.</p>
<p>The dataset can be down load <a href="https://drive.google.com/file/d/0By9Y49AzZGaUemtpNWtQMWdqRDA/view">here</a>.</p>
<p>The dataset contains 10000 rows with 14 columns. I am not explaining data in detail as dataset is self explanatory.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Importing-data">Importing data<a class="anchor-link" href="#Importing-data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Importing the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># Importing the dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data\Churn_Modelling.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(10000, 14)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[1]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RowNumber</th>
      <th>CustomerId</th>
      <th>Surname</th>
      <th>CreditScore</th>
      <th>Geography</th>
      <th>Gender</th>
      <th>Age</th>
      <th>Tenure</th>
      <th>Balance</th>
      <th>NumOfProducts</th>
      <th>HasCrCard</th>
      <th>IsActiveMember</th>
      <th>EstimatedSalary</th>
      <th>Exited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>15634602</td>
      <td>Hargrave</td>
      <td>619</td>
      <td>France</td>
      <td>Female</td>
      <td>42</td>
      <td>2</td>
      <td>0.00</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>101348.88</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15647311</td>
      <td>Hill</td>
      <td>608</td>
      <td>Spain</td>
      <td>Female</td>
      <td>41</td>
      <td>1</td>
      <td>83807.86</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>112542.58</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15619304</td>
      <td>Onio</td>
      <td>502</td>
      <td>France</td>
      <td>Female</td>
      <td>42</td>
      <td>8</td>
      <td>159660.80</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>113931.57</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>15701354</td>
      <td>Boni</td>
      <td>699</td>
      <td>France</td>
      <td>Female</td>
      <td>39</td>
      <td>1</td>
      <td>0.00</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>93826.63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>15737888</td>
      <td>Mitchell</td>
      <td>850</td>
      <td>Spain</td>
      <td>Female</td>
      <td>43</td>
      <td>2</td>
      <td>125510.82</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>79084.10</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-training-and-test-set">Creating training and test set<a class="anchor-link" href="#Creating-training-and-test-set">&#182;</a></h2><p>Create matrix of features and matrix of target variable. In this case we are excluding column 1 &amp; 2 as those are ‘row_number’ and ‘customerid’ which are not useful in our analysis. Column 14, ‘Exited’ is our Target Variable</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us take a glimpse on the predictors in X. As can be seen below, the dataset is pretty clean. Only two columns of string variables need to be transferred to categorical variables or one hot values in order to be fed into a classifier.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[619 &#39;France&#39; &#39;Female&#39; ... 1 1 101348.88]
 [608 &#39;Spain&#39; &#39;Female&#39; ... 0 1 112542.58]
 [502 &#39;France&#39; &#39;Female&#39; ... 1 0 113931.57]
 ...
 [709 &#39;France&#39; &#39;Female&#39; ... 0 1 42085.58]
 [772 &#39;Germany&#39; &#39;Male&#39; ... 1 0 92888.52]
 [792 &#39;France&#39; &#39;Female&#39; ... 1 0 38190.78]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The target y only contains 0s and 1s as 0 stands for customers still with us, and 1 represents customers left us.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[1 0 1 ... 1 1 0]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Encoding categorical variables</em>: we need to use the LabelEncoder and OneHotEncoder from the sklearn to transform string variables in X. Use LabelEncoder first to encode different labels in a certain column to numbers between 0 to n_class-1. Then, use OneHotEncoder to tranform the numbers into one hot manner.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="n">labelencoder_X_1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">labelencoder_X_2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">X</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[619, 0, 0, ..., 1, 1, 101348.88],
       [608, 2, 0, ..., 0, 1, 112542.58],
       [502, 0, 0, ..., 1, 0, 113931.57],
       ...,
       [709, 0, 0, ..., 0, 1, 42085.58],
       [772, 1, 1, ..., 1, 0, 92888.52],
       [792, 0, 0, ..., 1, 0, 38190.78]], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you can see that Country names are replaced by 0,1 and 2 while male and female are replaced by 0 and 1.</p>
<p>Label encoding has introduced new problem in our data. LabelEncoder has replaced France with 0, Germany 1 and Spain 2 but Germany is not higher than France and France is not smaller than Spain so we need to create a dummy variable for Country. We don’t need to do same for Gender Variable as it is binary.</p>
<p>Here, we use the OneHotEncoder to do the job.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onehotencoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">onehotencoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[0.0000000e+00, 0.0000000e+00, 6.1900000e+02, ..., 1.0000000e+00,
        1.0000000e+00, 1.0134888e+05],
       [0.0000000e+00, 1.0000000e+00, 6.0800000e+02, ..., 0.0000000e+00,
        1.0000000e+00, 1.1254258e+05],
       [0.0000000e+00, 0.0000000e+00, 5.0200000e+02, ..., 1.0000000e+00,
        0.0000000e+00, 1.1393157e+05],
       ...,
       [0.0000000e+00, 0.0000000e+00, 7.0900000e+02, ..., 0.0000000e+00,
        1.0000000e+00, 4.2085580e+04],
       [1.0000000e+00, 0.0000000e+00, 7.7200000e+02, ..., 1.0000000e+00,
        0.0000000e+00, 9.2888520e+04],
       [0.0000000e+00, 0.0000000e+00, 7.9200000e+02, ..., 1.0000000e+00,
        0.0000000e+00, 3.8190780e+04]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Assigning-training-set-and-test-set">Assigning training set and test set<a class="anchor-link" href="#Assigning-training-set-and-test-set">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Splitting the dataset into the Training set and Test set</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preprocessing">Preprocessing<a class="anchor-link" href="#Preprocessing">&#182;</a></h3><p>We are going to fitting and transforming StandardScaler method on both the training. In order to make our model work on test data, we have to standardize our scaling so we will use the same fitted method to transform/scale test data.</p>
<p>Standardize features by removing the mean and scaling to unit variance</p>
<p>The standard score of a sample x is calculated as:</p>
<p>z = (x - u) / s</p>
<p>where u is the mean of the training samples or zero if with_mean=False, and s is the standard deviation of the training samples or one if with_std=False.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Feature Scaling</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, the preprocessing on our data is done. We will start building our neural network model. The library we use to build our NN model is Keras. Keras is a high-level neural networks API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano. It was developed with a focus on enabling fast experimentation.</p>
<p>We need <strong>Sequential</strong> module for initializing NN and <strong>Dense</strong> module to add Hidden Layers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Importing the Keras libraries and packages</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>D:\ANOCONDA\lib\site-packages\h5py\__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Initializing Neural Network</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adding layers to the neural network. Which activation function should be used is critical task. Here we are using rectifier(relu) function in our hidden layer and Sigmoid function in our output layer as we want binary result from output layer but if the number of categories in output layer is more than 2 then use SoftMax function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Adding the input layer and the first hidden layer</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
<span class="c1"># Adding the second hidden layer</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
<span class="c1"># Adding the output layer</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Till now we have added multiple layers to out classifier now let’s compile them which can be done using compile method. Arguments added in final compilation will control whole neural network so be careful on this step.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compiling Neural Network</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will now train our model on training data but still one thing is remaining. We use fit method to the fit our model In previous some steps I said that we will be optimizing our weights to improve model efficiency so when are we updating out weights? Batch size is used to specify the number of observation after which you want to update weight. Epoch is nothing but the total number of iterations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fitting our model </span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
8000/8000 [==============================] - 2s 202us/step - loss: 0.4914 - acc: 0.8006
Epoch 2/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.4090 - acc: 0.8232
Epoch 3/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3953 - acc: 0.8291
Epoch 4/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3854 - acc: 0.8310
Epoch 5/100
8000/8000 [==============================] - 1s 153us/step - loss: 0.3782 - acc: 0.8322
Epoch 6/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3724 - acc: 0.8431
Epoch 7/100
8000/8000 [==============================] - 1s 142us/step - loss: 0.3688 - acc: 0.8449
Epoch 8/100
8000/8000 [==============================] - 1s 144us/step - loss: 0.3655 - acc: 0.8459
Epoch 9/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3628 - acc: 0.8506
Epoch 10/100
8000/8000 [==============================] - 1s 144us/step - loss: 0.3599 - acc: 0.8527
Epoch 11/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3571 - acc: 0.8526
Epoch 12/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3556 - acc: 0.8530
Epoch 13/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3544 - acc: 0.8531
Epoch 14/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3532 - acc: 0.8550
Epoch 15/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3509 - acc: 0.8560
Epoch 16/100
8000/8000 [==============================] - 1s 144us/step - loss: 0.3500 - acc: 0.8589
Epoch 17/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3500 - acc: 0.8576
Epoch 18/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3496 - acc: 0.8596
Epoch 19/100
8000/8000 [==============================] - 1s 152us/step - loss: 0.3485 - acc: 0.8572
Epoch 20/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3482 - acc: 0.8571
Epoch 21/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3476 - acc: 0.8587
Epoch 22/100
8000/8000 [==============================] - 1s 143us/step - loss: 0.3466 - acc: 0.8547
Epoch 23/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3470 - acc: 0.8585
Epoch 24/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3458 - acc: 0.8584
Epoch 25/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3458 - acc: 0.8590
Epoch 26/100
8000/8000 [==============================] - 1s 164us/step - loss: 0.3466 - acc: 0.8602
Epoch 27/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3447 - acc: 0.8591
Epoch 28/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3446 - acc: 0.8581
Epoch 29/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3439 - acc: 0.8590
Epoch 30/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3450 - acc: 0.8581
Epoch 31/100
8000/8000 [==============================] - 1s 153us/step - loss: 0.3445 - acc: 0.8592
Epoch 32/100
8000/8000 [==============================] - 1s 162us/step - loss: 0.3435 - acc: 0.8592
Epoch 33/100
8000/8000 [==============================] - 1s 158us/step - loss: 0.3424 - acc: 0.8607
Epoch 34/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3432 - acc: 0.8580
Epoch 35/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3433 - acc: 0.8597
Epoch 36/100
8000/8000 [==============================] - 1s 151us/step - loss: 0.3431 - acc: 0.8592
Epoch 37/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3430 - acc: 0.8609
Epoch 38/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3428 - acc: 0.8579
Epoch 39/100
8000/8000 [==============================] - 1s 153us/step - loss: 0.3424 - acc: 0.8595
Epoch 40/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3421 - acc: 0.8585
Epoch 41/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3419 - acc: 0.8592
Epoch 42/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3421 - acc: 0.8597
Epoch 43/100
8000/8000 [==============================] - 1s 156us/step - loss: 0.3419 - acc: 0.8582
Epoch 44/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3403 - acc: 0.8609
Epoch 45/100
8000/8000 [==============================] - 1s 184us/step - loss: 0.3414 - acc: 0.8569
Epoch 46/100
8000/8000 [==============================] - 1s 157us/step - loss: 0.3413 - acc: 0.8585
Epoch 47/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3414 - acc: 0.8606
Epoch 48/100
8000/8000 [==============================] - 1s 152us/step - loss: 0.3419 - acc: 0.8589
Epoch 49/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3411 - acc: 0.8589
Epoch 50/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3419 - acc: 0.8575
Epoch 51/100
8000/8000 [==============================] - 1s 156us/step - loss: 0.3403 - acc: 0.8617
Epoch 52/100
8000/8000 [==============================] - 1s 157us/step - loss: 0.3400 - acc: 0.8597
Epoch 53/100
8000/8000 [==============================] - 1s 155us/step - loss: 0.3409 - acc: 0.8596
Epoch 54/100
8000/8000 [==============================] - 1s 157us/step - loss: 0.3402 - acc: 0.8611
Epoch 55/100
8000/8000 [==============================] - 1s 158us/step - loss: 0.3401 - acc: 0.8591
Epoch 56/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3403 - acc: 0.8582
Epoch 57/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3404 - acc: 0.8622
Epoch 58/100
8000/8000 [==============================] - 1s 163us/step - loss: 0.3406 - acc: 0.8577
Epoch 59/100
8000/8000 [==============================] - 1s 160us/step - loss: 0.3394 - acc: 0.8592
Epoch 60/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3393 - acc: 0.8621
Epoch 61/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3411 - acc: 0.8601
Epoch 62/100
8000/8000 [==============================] - 1s 152us/step - loss: 0.3397 - acc: 0.8589
Epoch 63/100
8000/8000 [==============================] - 1s 160us/step - loss: 0.3400 - acc: 0.8590
Epoch 64/100
8000/8000 [==============================] - 1s 151us/step - loss: 0.3405 - acc: 0.8590
Epoch 65/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3395 - acc: 0.8606
Epoch 66/100
8000/8000 [==============================] - 1s 149us/step - loss: 0.3392 - acc: 0.8579
Epoch 67/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3397 - acc: 0.8590
Epoch 68/100
8000/8000 [==============================] - 1s 151us/step - loss: 0.3396 - acc: 0.8602
Epoch 69/100
8000/8000 [==============================] - 1s 162us/step - loss: 0.3390 - acc: 0.8610
Epoch 70/100
8000/8000 [==============================] - 1s 156us/step - loss: 0.3395 - acc: 0.8595
Epoch 71/100
8000/8000 [==============================] - 1s 165us/step - loss: 0.3389 - acc: 0.8597
Epoch 72/100
8000/8000 [==============================] - 1s 162us/step - loss: 0.3391 - acc: 0.8601
Epoch 73/100
8000/8000 [==============================] - 1s 156us/step - loss: 0.3389 - acc: 0.8605
Epoch 74/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3395 - acc: 0.8600
Epoch 75/100
8000/8000 [==============================] - 1s 151us/step - loss: 0.3391 - acc: 0.8600
Epoch 76/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3397 - acc: 0.8621
Epoch 77/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3385 - acc: 0.8614
Epoch 78/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3393 - acc: 0.8585
Epoch 79/100
8000/8000 [==============================] - 1s 152us/step - loss: 0.3390 - acc: 0.8597
Epoch 80/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3388 - acc: 0.8615
Epoch 81/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3395 - acc: 0.8622
Epoch 82/100
8000/8000 [==============================] - 1s 144us/step - loss: 0.3387 - acc: 0.8597
Epoch 83/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3385 - acc: 0.8602
Epoch 84/100
8000/8000 [==============================] - 1s 173us/step - loss: 0.3388 - acc: 0.8589
Epoch 85/100
8000/8000 [==============================] - 1s 166us/step - loss: 0.3389 - acc: 0.8617
Epoch 86/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3385 - acc: 0.8625
Epoch 87/100
8000/8000 [==============================] - 1s 154us/step - loss: 0.3379 - acc: 0.8579
Epoch 88/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3391 - acc: 0.8601
Epoch 89/100
8000/8000 [==============================] - 1s 147us/step - loss: 0.3378 - acc: 0.8601
Epoch 90/100
8000/8000 [==============================] - 1s 148us/step - loss: 0.3388 - acc: 0.8611
Epoch 91/100
8000/8000 [==============================] - 1s 153us/step - loss: 0.3384 - acc: 0.8596
Epoch 92/100
8000/8000 [==============================] - 1s 153us/step - loss: 0.3381 - acc: 0.8596
Epoch 93/100
8000/8000 [==============================] - 1s 150us/step - loss: 0.3380 - acc: 0.8576
Epoch 94/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3379 - acc: 0.8582
Epoch 95/100
8000/8000 [==============================] - 1s 146us/step - loss: 0.3376 - acc: 0.8591
Epoch 96/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3374 - acc: 0.8619
Epoch 97/100
8000/8000 [==============================] - 1s 157us/step - loss: 0.3370 - acc: 0.8626
Epoch 98/100
8000/8000 [==============================] - 1s 156us/step - loss: 0.3355 - acc: 0.8580
Epoch 99/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3361 - acc: 0.8625
Epoch 100/100
8000/8000 [==============================] - 1s 145us/step - loss: 0.3354 - acc: 0.8619
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x232a0752320&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Predicting-on-the-test-data">Predicting on the test data<a class="anchor-link" href="#Predicting-on-the-test-data">&#182;</a></h3><p>Predicting the test set result. The prediction result will give you probability of the customer leaving the company. We will convert that probability into binary 0 and 1.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Predicting the Test set results</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Confusion-matrix-of-test-set-and-prediction-accuracy">Confusion matrix of test set and prediction accuracy<a class="anchor-link" href="#Confusion-matrix-of-test-set-and-prediction-accuracy">&#182;</a></h3><p>This is the final step where we are evaluating our model performance. We already have original results and thus we can build confusion matrix to check the accuracy of model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Creating the Confusion Matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">cm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1477,  111],
       [ 186,  226]], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="n">test_accuracy</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8515</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We achieved 85.15% accuracy on the test set which is quite good.</p>
<h2 id="Adjusting-the-neural-network">Adjusting the neural network<a class="anchor-link" href="#Adjusting-the-neural-network">&#182;</a></h2><p>Let's changing the structure of the network to see what happens. Let's add another hidden layer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Initializing Neural Network</span>
<span class="n">classifier2</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Adding the input layer and the first hidden layer</span>
<span class="n">classifier2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
<span class="c1"># Adding the second hidden layer</span>
<span class="n">classifier2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
<span class="c1"># Adding the third hidden layer</span>
<span class="n">classifier2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
<span class="c1"># Adding the output layer</span>
<span class="n">classifier2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>

<span class="c1"># Compiling Neural Network</span>
<span class="n">classifier2</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="c1"># Fitting our model </span>
<span class="n">classifier2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Predicting the Test set results</span>
<span class="n">y_pred2</span> <span class="o">=</span> <span class="n">classifier2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred2</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred2</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cm2</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred2</span><span class="p">)</span>
<span class="n">test_accuracy2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">cm2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cm2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cm2</span><span class="p">)</span>
<span class="n">test_accuracy2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
8000/8000 [==============================] - 2s 280us/step - loss: 0.4712 - acc: 0.7961
Epoch 2/100
8000/8000 [==============================] - 1s 186us/step - loss: 0.4183 - acc: 0.7969
Epoch 3/100
8000/8000 [==============================] - 2s 226us/step - loss: 0.4090 - acc: 0.8270
Epoch 4/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3973 - acc: 0.8306
Epoch 5/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3861 - acc: 0.8331
Epoch 6/100
8000/8000 [==============================] - 2s 203us/step - loss: 0.3772 - acc: 0.8431
Epoch 7/100
8000/8000 [==============================] - 2s 195us/step - loss: 0.3696 - acc: 0.8480
Epoch 8/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3659 - acc: 0.8495
Epoch 9/100
8000/8000 [==============================] - 2s 194us/step - loss: 0.3629 - acc: 0.8541
Epoch 10/100
8000/8000 [==============================] - 2s 198us/step - loss: 0.3613 - acc: 0.8555
Epoch 11/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3595 - acc: 0.8529
Epoch 12/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3587 - acc: 0.8561
Epoch 13/100
8000/8000 [==============================] - 2s 210us/step - loss: 0.3570 - acc: 0.8552
Epoch 14/100
8000/8000 [==============================] - 2s 217us/step - loss: 0.3554 - acc: 0.8560
Epoch 15/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3546 - acc: 0.8561
Epoch 16/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3544 - acc: 0.8564
Epoch 17/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3532 - acc: 0.8571
Epoch 18/100
8000/8000 [==============================] - 2s 202us/step - loss: 0.3517 - acc: 0.8595
Epoch 19/100
8000/8000 [==============================] - 2s 190us/step - loss: 0.3513 - acc: 0.8582
Epoch 20/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3516 - acc: 0.8562
Epoch 21/100
8000/8000 [==============================] - 2s 211us/step - loss: 0.3506 - acc: 0.8579
Epoch 22/100
8000/8000 [==============================] - 2s 204us/step - loss: 0.3485 - acc: 0.8589
Epoch 23/100
8000/8000 [==============================] - 2s 208us/step - loss: 0.3500 - acc: 0.8586
Epoch 24/100
8000/8000 [==============================] - 2s 202us/step - loss: 0.3505 - acc: 0.8579
Epoch 25/100
8000/8000 [==============================] - 2s 215us/step - loss: 0.3487 - acc: 0.8581
Epoch 26/100
8000/8000 [==============================] - 2s 210us/step - loss: 0.3484 - acc: 0.8594
Epoch 27/100
8000/8000 [==============================] - 2s 195us/step - loss: 0.3488 - acc: 0.8602
Epoch 28/100
8000/8000 [==============================] - 2s 197us/step - loss: 0.3486 - acc: 0.8574
Epoch 29/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3477 - acc: 0.8592
Epoch 30/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3480 - acc: 0.8590
Epoch 31/100
8000/8000 [==============================] - 2s 195us/step - loss: 0.3473 - acc: 0.8589
Epoch 32/100
8000/8000 [==============================] - 2s 201us/step - loss: 0.3458 - acc: 0.8587
Epoch 33/100
8000/8000 [==============================] - 2s 205us/step - loss: 0.3461 - acc: 0.8591
Epoch 34/100
8000/8000 [==============================] - 2s 200us/step - loss: 0.3452 - acc: 0.8616
Epoch 35/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3453 - acc: 0.8560
Epoch 36/100
8000/8000 [==============================] - 2s 202us/step - loss: 0.3454 - acc: 0.8581
Epoch 37/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3454 - acc: 0.8599
Epoch 38/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3454 - acc: 0.8585
Epoch 39/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3441 - acc: 0.8604
Epoch 40/100
8000/8000 [==============================] - 2s 197us/step - loss: 0.3443 - acc: 0.8596
Epoch 41/100
8000/8000 [==============================] - 2s 194us/step - loss: 0.3433 - acc: 0.8582
Epoch 42/100
8000/8000 [==============================] - 1s 187us/step - loss: 0.3435 - acc: 0.8586
Epoch 43/100
8000/8000 [==============================] - 2s 215us/step - loss: 0.3438 - acc: 0.8594
Epoch 44/100
8000/8000 [==============================] - 2s 206us/step - loss: 0.3436 - acc: 0.8590
Epoch 45/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3431 - acc: 0.8612
Epoch 46/100
8000/8000 [==============================] - 1s 187us/step - loss: 0.3431 - acc: 0.8599
Epoch 47/100
8000/8000 [==============================] - 2s 201us/step - loss: 0.3440 - acc: 0.8596
Epoch 48/100
8000/8000 [==============================] - 2s 190us/step - loss: 0.3427 - acc: 0.8602
Epoch 49/100
8000/8000 [==============================] - 2s 188us/step - loss: 0.3433 - acc: 0.8606
Epoch 50/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3415 - acc: 0.8621
Epoch 51/100
8000/8000 [==============================] - 2s 201us/step - loss: 0.3430 - acc: 0.8587
Epoch 52/100
8000/8000 [==============================] - 2s 188us/step - loss: 0.3418 - acc: 0.8600
Epoch 53/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3427 - acc: 0.8611
Epoch 54/100
8000/8000 [==============================] - 2s 217us/step - loss: 0.3415 - acc: 0.8612
Epoch 55/100
8000/8000 [==============================] - 2s 194us/step - loss: 0.3423 - acc: 0.8599
Epoch 56/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3421 - acc: 0.8604
Epoch 57/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3417 - acc: 0.8609 0s - loss: 0.3412 - a
Epoch 58/100
8000/8000 [==============================] - 2s 202us/step - loss: 0.3426 - acc: 0.8599
Epoch 59/100
8000/8000 [==============================] - 2s 188us/step - loss: 0.3414 - acc: 0.8605
Epoch 60/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3424 - acc: 0.8607
Epoch 61/100
8000/8000 [==============================] - 2s 193us/step - loss: 0.3413 - acc: 0.8616
Epoch 62/100
8000/8000 [==============================] - 2s 199us/step - loss: 0.3418 - acc: 0.8611
Epoch 63/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3408 - acc: 0.8604
Epoch 64/100
8000/8000 [==============================] - 2s 210us/step - loss: 0.3411 - acc: 0.8626
Epoch 65/100
8000/8000 [==============================] - 2s 197us/step - loss: 0.3418 - acc: 0.8625
Epoch 66/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3411 - acc: 0.8621
Epoch 67/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3412 - acc: 0.8591
Epoch 68/100
8000/8000 [==============================] - 2s 188us/step - loss: 0.3404 - acc: 0.8607
Epoch 69/100
8000/8000 [==============================] - 2s 197us/step - loss: 0.3406 - acc: 0.8619
Epoch 70/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3407 - acc: 0.8590
Epoch 71/100
8000/8000 [==============================] - 2s 188us/step - loss: 0.3417 - acc: 0.8601
Epoch 72/100
8000/8000 [==============================] - 2s 189us/step - loss: 0.3414 - acc: 0.8615
Epoch 73/100
8000/8000 [==============================] - 2s 208us/step - loss: 0.3407 - acc: 0.8607
Epoch 74/100
8000/8000 [==============================] - 2s 222us/step - loss: 0.3413 - acc: 0.8615
Epoch 75/100
8000/8000 [==============================] - 2s 210us/step - loss: 0.3411 - acc: 0.8620
Epoch 76/100
8000/8000 [==============================] - 2s 197us/step - loss: 0.3394 - acc: 0.8610
Epoch 77/100
8000/8000 [==============================] - 2s 203us/step - loss: 0.3405 - acc: 0.8626
Epoch 78/100
8000/8000 [==============================] - 2s 195us/step - loss: 0.3403 - acc: 0.8586
Epoch 79/100
8000/8000 [==============================] - 2s 201us/step - loss: 0.3399 - acc: 0.8624
Epoch 80/100
8000/8000 [==============================] - 2s 204us/step - loss: 0.3404 - acc: 0.8600 0s - loss: 0.3438 - a
Epoch 81/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3392 - acc: 0.8632
Epoch 82/100
8000/8000 [==============================] - 2s 200us/step - loss: 0.3399 - acc: 0.8617
Epoch 83/100
8000/8000 [==============================] - 2s 195us/step - loss: 0.3395 - acc: 0.8622
Epoch 84/100
8000/8000 [==============================] - 2s 222us/step - loss: 0.3389 - acc: 0.8611
Epoch 85/100
8000/8000 [==============================] - 2s 198us/step - loss: 0.3401 - acc: 0.8606
Epoch 86/100
8000/8000 [==============================] - 2s 191us/step - loss: 0.3397 - acc: 0.8631
Epoch 87/100
8000/8000 [==============================] - 2s 198us/step - loss: 0.3388 - acc: 0.8626
Epoch 88/100
8000/8000 [==============================] - 2s 203us/step - loss: 0.3404 - acc: 0.8616
Epoch 89/100
8000/8000 [==============================] - 2s 193us/step - loss: 0.3398 - acc: 0.8629
Epoch 90/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3394 - acc: 0.8609
Epoch 91/100
8000/8000 [==============================] - 2s 202us/step - loss: 0.3397 - acc: 0.8607
Epoch 92/100
8000/8000 [==============================] - 2s 197us/step - loss: 0.3396 - acc: 0.8611
Epoch 93/100
8000/8000 [==============================] - 2s 194us/step - loss: 0.3391 - acc: 0.8632
Epoch 94/100
8000/8000 [==============================] - 2s 208us/step - loss: 0.3395 - acc: 0.8619
Epoch 95/100
8000/8000 [==============================] - 2s 219us/step - loss: 0.3390 - acc: 0.8614
Epoch 96/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3389 - acc: 0.8632
Epoch 97/100
8000/8000 [==============================] - 2s 192us/step - loss: 0.3394 - acc: 0.8634
Epoch 98/100
8000/8000 [==============================] - 2s 196us/step - loss: 0.3396 - acc: 0.8620
Epoch 99/100
8000/8000 [==============================] - 2s 200us/step - loss: 0.3376 - acc: 0.8625
Epoch 100/100
8000/8000 [==============================] - 2s 190us/step - loss: 0.3392 - acc: 0.8605
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.8555</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now the prediction accuracy on test set has increased a little bit from 85.15% to 85.55%.</p>
<p>Adjusting the architect of the neural network may achieve better results.</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="https://ericchen23.github.io/2018/09/Naive-Bayes.html">Indian diabetes database modeling using Naive Bayes</a></li>
        <li><a href="https://ericchen23.github.io/2018/08/SAT-analysis.html">SAT Results Analysis NYC</a></li>
        <li><a href="https://ericchen23.github.io/2019/09/NLP-twitter-sentiment.html">Twitter Sentiment Modeling on Detecting Racist or Sexist tweets</a></li>
        <li><a href="https://ericchen23.github.io/2019/08/NLP-topic-modeling.html">Modeling on Amazon Phone and Accessories Reviews using NLP</a></li>
        <li><a href="https://ericchen23.github.io/2019/01/car-crash-prediction-nz.html">Car Crash Prediction in NZ - Machine Learning Pipeline</a></li>
    </ul>
</section>
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="https://ericchen23.github.io/images/profile.jpg"/>
        </p>
    <p>
      <strong>About Eric Chen</strong><br/>
        <span>I love Data Science and Analytics. I love to explore the wonderful world of data, and love to improve myself day by day.</span>
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/in/hao-chen-auckland/"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
    <li class="list-group-item"><a href="https://www.facebook.com/profile.php?id=100008887505096"><i class="fa fa-facebook-square fa-lg"></i> Facebook</a></li>
    <li class="list-group-item"><a href="https://github.com/haochen23"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="https://ericchen23.github.io/2019/09/NLP-twitter-sentiment.html">Twitter Sentiment Modeling on Detecting Racist or Sexist tweets</a></li>
    <li class="list-group-item"><a href="https://ericchen23.github.io/2019/08/NLP-topic-modeling.html">Modeling on Amazon Phone and Accessories Reviews using NLP</a></li>
    <li class="list-group-item"><a href="https://ericchen23.github.io/2019/02/time-series-analysis-superstore-sales.html">Time Series Analysis on Superstore Sales Data</a></li>
    <li class="list-group-item"><a href="https://ericchen23.github.io/2019/01/car-crash-prediction-nz.html">Car Crash Prediction in NZ - Machine Learning Pipeline</a></li>
    <li class="list-group-item"><a href="https://ericchen23.github.io/2018/12/50-visualization-part3.html">Valuable Matplotlib & Seaborn Visualization Handbook, Part III</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="https://ericchen23.github.io/label/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-1">
      <a href="https://ericchen23.github.io/label/analytics/">Analytics</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://ericchen23.github.io/label/car-crash-prediction/">Car Crash Prediction</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://ericchen23.github.io/label/data-science/">Data Science</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://ericchen23.github.io/label/data-visualization/">Data Visualization</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://ericchen23.github.io/label/matplotlib/">Matplotlib</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://ericchen23.github.io/label/nlp/">NLP</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://ericchen23.github.io/label/sales-forecasting/">Sales Forecasting</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://ericchen23.github.io/label/seaborn/">Seaborn</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://ericchen23.github.io/label/sentiment-analysis/">Sentiment analysis</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://ericchen23.github.io/label/time-series-analysis/">Time Series Analysis</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://ericchen23.github.io/label/topic-modeling/">Topic Modeling</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://ericchen23.github.io/label/xgboost/">xgboost</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
</li>
<!-- End Sidebar/Github -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2019 Eric Chen
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://ericchen23.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://ericchen23.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://ericchen23.github.io/theme/js/respond.min.js"></script>



<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = 'https://ericchen23.github.io/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'haochen23',
    count: 5,
    skip_forks: false,
    target: '#gh_repos'
  });
});
</script>
<script src="https://ericchen23.github.io/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-59403121442ae6be"></script>
</body>
</html>